I malware sono programmi ad hoc che compiono azioni malevole. Non sfruttano bug o vulnerabilità del sistema, ma attraverso l'inganno portano un amministratore di sistema a installarlo ed eseguirlo. Il malware ha gli stessi permessi dell'utente che lo esegue, nel caso di Windows (fino a 8), l'utente normale era anche amministratore, quindi semplice preda di malware che richiedevano permessi elevati.

## Categorie

- **Propagation:**
  - **Virus:** richiede l'intervento umano (esempio: apertura di allegato email infetto)
  - **Worm:** propagazione automatica (esempio: Morris worm)
- **Concealment:**
  - **Rootkit**: intacca il sistema operativo per nascondersi
  - **Trojan**: compie operazioni malevole fingendosi un applicativo utile
- **Payload**: quantità di danno apportato a un sistema

Le classificazioni avvengono per **tipo**, **comportamento** e **privilegio**.

### Logic bomb

Tipo particolare di malware con meccanismi malevoli che scattano al verificarsi di una certa condizione, ad esempio raggiunta una certa data o compiuta una specifica azione, fingendosi prima di tale momento come un programma normale.

## Computer virus

È un malware che si replica infettando altri file o programmi per garantire la propria sopravvivenza. È necessario un l'intervento di un utente per essere attivato.

#### Fasi

- **Dormiente**: esiste ma non si attiva per non essere rilevato
- **Propagazione**: si moltiplica, evitando di infettare file già intaccati. Per distinguerli marca con una *signature* i file già compromessi. Gli antivirus rilevano le signature, quindi un produttore si deve occupare di scrivere un virus che non sia rilevabile
- **Attivazione**
- **Attacco**

Un virus è detto **resident** se rimane in esecuzione anche dopo essere stato eseguito un file infetto, altrimenti, se  persiste anche dopo la terminazione del suddetto, è detto **non-resident**.

#### Hosts

- Settori di boot
- File eseguibili
- Documenti che consentono l'inclusione di macro

## Concealment

Per nascondersi, un virus potrebbes seguire diverse strategie:

- **Encrypted virus**: il corpo del virus viene cifrato lasciando una sola funzione in chiaro, quella che si occupa di decrittare il resto del codice. La chiave viene continuamente modificata, quindi il corpo è sempre diverso. Vengono rilevati dagli antivirus dato il contenuto insolito (funzione in chiaro + corpo cifrato).
- **Polymorphic virus**: la funzione di decifratura si automodifica tra una generazione e l'altra. Non sono più rilevabili attraverso signature. Per rilevare virus di questo tipo, gli antivirus lanciano gli esegubili all'interno di una macchina virtuale e ne studiano il comportamento per stabilire se si tratta di un programma dannoso
- **Metamorphic virus**: un virus metamorfo modifica anche il proprio funzionamento; sono estremamente difficili da realizzare, ma sfuggono ai controlli per rilevare virus polimorfi. Data la complessità, per raggirare un antivirus si utilizza altrimenti un virus polimorfo capace di stabilire se si trova in esecuzione in una macchina virtuale, in questo caso si comporta normalmente.

## Worm

Il primo Worm della storia è il Morris Worm.

Un worm non ha bisogno dell'intervento umano per riprodursi e attaccare. Per fare ciò ha bisogno di una rete su cui replicarsi e di alcune vulnerabilità di qualche servizio di rete. Compromette un servizio di rete attraverso un attacco buffer overflow ed esegue codice per attaccare e riprodursi nella rete autonomamente.

Per creare un worm occorre:

- Individuare una vulnerabilità
- Generare una lista di host da attaccare
- Installare ed eseguire il payload. Solitamente si crea un demone che riceve comandi da remoto

### Dictionary attack

Tecnica che i worm utilizzano per rubare password relativamente fragili e ottenere l'accesso a un host. Si basa sul concetto di identificazione di un utente all'interno di un sistema (solitamente attraverso username o email).L'identificazione di un utente avviene secondo tre strategie:

- **what you know**: un segreto tra utente e sistema (password)
- **what you have**: un oggetto, ad esempio una carta di credito, un dispositivo dedicato o la verifica in due passaggi attraverso un altro dispositivo
- **what you are**: attraverso biometria

I paradigmi possono essere mischiati, in questo caso si parla di autenticazione forte.

#### Password

Ad oggi, sebbene non sia la strategia più sicura, l'autenticazione attraverso password è la più utilizzata. Le password non sono note al sistema e quindi nemmeno all'amministratore, dato che vengono applicati algoritmi di hashing su di esse e salvati soltanto gli output. All'accesso viene confrontato l'hash della parola chiave in input con l'hash salvato. Nei sistemi Unix, gli hash delle password sono contenute in `/etc/shadow`, file accessibile solo all'utente root.

Il meccanismo delle password, sebbene sia teoricamente infallibile, presenta diverse vulnerabilità. Le vulnerabilità sono prettamente lato utente, dato che spesso sceglie password poco sicure.

Per violare una password ci sono strategie low-tech, attraverso il social engineering (spesso le password sono legate a interessi della persona), o high-tech.

Gli approcci high tech sono essenzialmente 3:

-  **brute-force**: ricerca esaustiva (molto costosa con password anche di lunghezza media)
- **dictionary attack**: si raccoglie un database di parole frequenti in un certo contesto. Il programma tenta tutte le parole nel dizionario, hashando le entry e confrontandole con gli hash in `/etc/shadow`.
- **rainbow attack**: parte da un database che raccoglie corrispondenze tra password e hash, più rapido quindi di un dictionary attack, dato che non è necessario calcolare gli hash in fase di cracking. Può essere evitato aggiungendo un salt, ovvero una stringa casuale specifica per ogni utente che viene concatenata alla password prima di essere hashata e concatenata anche a ogni input.

# Tecniche d'attacco

L'obiettivo principale di un produttore di malware è convincere un utente a compiere un'azione che non dovrebbe fare. Lo studio di questo fenomeno psicologico è detto **social engineering**. Si tratta di tecniche di manipolazione, al fine di "truffare" l'utente.

È legato alla psicologia e si basa su un meccanismo, l'euristica, che il cervello mette in atto in situazioni di stress. In breve, il cervello applica regole empiriche per agire rapidamente in casi emergenziali. Questo comportamento porta talvolta a fare azioni che in normali situazioni una persona non farebbe. 

Quattro situazioni possono innescare euristiche:

- **Sovraccarico di informazioni**: troppe informazioni difficili da processare portano a innescare bias cognitivi
- **Mancanza di informazioni:** anche una quantità insufficiente di informazioni porta a bias
- **Azione rapida:** quando è necessario agire rapidamente si tende ad applicare "scorciatoie"
- **Affaticamento decisionale**: azioni ripetute portano il cervello a stancarsi e ad applicare euristiche spesso sconvenienti

Le euristiche portano a *bias* cognitivi, ovvero all'applicazione di pregiudizi. Un esempio di bias è l'[anchoring](https://en.wikipedia.org/wiki/Anchoring_(cognitive_bias)).

Il processo per portare un utente a eseguire un malware è il seguente:

- Creare una situazione di pressione nell'individuo
- Si attiva l'uso di euristiche
- Potrebbero attivarsi alcuni bias cognitivi nella persona e di conseguenza potrebbero verificarsi specifici errori che l'attaccante si aspetta
- Un attaccante può sfruttare gli errori derivanti da suddetti bias

Per recuperare alcuni dati si effettuano alcune operazioni "non tecnologiche" come:

- **Shoulder surfing**: spiare durante l'immissione di password

- **Dumpster diving**: rovistare tra documenti buttati

### Phishing

Sono tentativi di rubare informazioni personali e finanziarie o infettare computer e altri dispositivi con malware. Sono spesso sotto forma di email e siti web allarmistici, che fingono di provenire da aziende riconosciute. Raccolgono le informazioni cedute dall'utente, come numeri di carta di credito o password.

I dati raccolti vengono solitamente venduti al mercato nero.

Esistono diversi tipi di phishing:

- **Mass phishing**: il più diffuso, viene generata una mail e mandata a più gente possibile
- **Spear phishing**: vengono individuate persone specifiche da attaccare, più difficili da riconoscere data la specificità del contenuto
- **Whaling**: tipo di attacco spear phishing che si rivolge a persone di alto rango.

L'**intelligenza artificiale** viene spesso impiegata in social engineering, ad esempio sintetizzando la voce o creando un video con il volto di un'altra persona (deepfake).

Attraverso L'*Advanced Natural Language Processing* si possono generare messaggi di phishing efficaci